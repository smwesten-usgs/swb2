program tests

  ! Driver program for FRUIT unit tests in:
  ! test_allocatable_string.F90
  ! test_datetime.F90
  ! test_exceptions__index_values_valid.F90
  ! test_FAO56_functions.F90
  ! test_gash.F90
  ! test_timer.F90

  ! Generated by FRUITPy.

  use fruit
  use test_allocatable_string
  use test_datetime
  use test_exceptions
  use test_FAO56_functions
  use test__gash
  use test_timer

  implicit none
  integer :: failed_count

  call init_fruit

  ! test_allocatable_string.F90:
  call run_test_case(test_string_list_with_character,"[ LOCALS ]")

  ! test_datetime.F90:
  call run_test_case(test_datetime_basic_dateparse,"datetime: parse with default mm/dd/yyyy date format")
  call run_test_case(test_datetime_illegal_values,"datetime: parse with non-existant day value")
  call run_test_case(test_datetime_basic_mangled_dateparse,"datetime: parse with default mm/dd/yyyy date format, missing '0' values in month and day")
  call run_test_case(test_datetime_custom_dateparse,"datetime: parse with custom yyyy-mm-dd date format")
  call run_test_case(test_datetime_addition_day,"datetime: add 5 to Julian day and return the correct Gregorian date")
  call run_test_case(test_datetime_julian_date_illegal_month,"datetime: supply illegal month value to Julian Date routine")
  call run_test_case(test_datetime_julian_date_illegal_day,"datetime: supply illegal day value to Julian Date routine")
  call run_test_case(test_datetime_julian_date_illegal_month_day,"datetime: supply illegal month and day value to Julian Date routine")
  call run_test_case(test_count_leap_days_between_dates,"test_count_leap_days_between_dates")
  call run_test_case(test_datetime_basic_addition,"datetime: add known quantity to datetime object")

  ! test_exceptions__index_values_valid.F90:
  call run_test_case(test_check_array_bounds_1d,"test_check_array_bounds_1d")

  ! test_FAO56_functions.F90:
  call setup_crop_coefficients__FAO56
  call run_test_case(test_crop_coefficients_parsing,"test_crop_coefficients_parsing")
  call run_test_case(test_crop_coefficients_basic,"test_crop_coefficients_basic")
  call run_test_case(test_gdd_max_plus_min_simple,"Values taken from:")
  call run_test_case(test_fao56_equation_72,"fao-56: test functioning of equation 72 implementation")
  call run_test_case(test_fao56_equation_72_v2,"fao-56: test functioning of equation 72 implementation against R implementation")
  call run_test_case(test_fao56_example_35,"test_fao56_example_35")

  ! test_gash.F90:
  call run_test_case(test_gash_psat_calculation,"gash: test calculation of Gash PSat")
  call run_test_case(test_gash_calculation,"gash: calculate Gash interception for published case")

  ! test_timer.F90:
  call run_test_case(test_timer_basic,"timer: test basic functionality - convert seconds to hms")
  call run_test_case(test_timer_split,"timer: test split and elapsed timer functionality")
  call run_test_case(test_timer_prettyprint,"timer: test ability to output in human-readable form")

  call get_failed_count(failed_count)
  call fruit_summary
  call fruit_finalize
  if (failed_count > 0) stop 1

end program tests